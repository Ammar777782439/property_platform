{% extends 'base.html' %}
{% load static %}
{% block title %}استكشاف الشاليهات{% endblock %}
{% block content %}
<form class="row g-3 align-items-end mb-4" method="get">
  <div class="col-md-3">
    <label class="form-label">بحث</label>
    <input type="text" name="q" class="form-control" placeholder="اسم/وصف/عنوان" value="{{ request.GET.q }}">
  </div>
  <div class="col-md-2">
    <label class="form-label">مدينة</label>
    <input type="text" name="city" class="form-control" value="{{ request.GET.city }}">
  </div>
  <div class="col-md-2">
    <label class="form-label">عدد النزلاء</label>
    <input type="number" min="1" name="guests" class="form-control" value="{{ request.GET.guests }}">
  </div>
  <div class="col-md-2">
    <label class="form-label">السعر الأدنى</label>
    <input type="number" step="0.01" name="price_min" class="form-control" value="{{ request.GET.price_min }}">
  </div>
  <div class="col-md-2">
    <label class="form-label">السعر الأقصى</label>
    <input type="number" step="0.01" name="price_max" class="form-control" value="{{ request.GET.price_max }}">
  </div>
  <div class="col-md-1">
    <button class="btn btn-primary w-100">بحث</button>
  </div>
</form>

<div class="row g-4">
  {% for p in properties %}
    <div class="col-md-4">
      <div class="card h-100 shadow-sm">
        {% if p.main_image %}
          <img src="{{ p.main_image.image_url }}" class="card-img-top" alt="{{ p.name }}">
        {% else %}
          <img src="https://placehold.co/600x400?text=Property" class="card-img-top" alt="...">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ p.name }}</h5>
          <p class="card-text text-muted mb-2">{{ p.city }} • {{ p.address }}</p>
          <p class="mt-auto fw-bold">ابتداءً من {{ p.default_daily_price }} ريال/ليلة</p>
          <a href="{% url 'property_detail' p.property_id %}" class="btn btn-outline-primary w-100">عرض التفاصيل</a>
        </div>
      </div>
    </div>
  {% empty %}
    <p>لا توجد نتائج مطابقة حالياً.</p>
  {% endfor %}
</div>
{% endblock %}
